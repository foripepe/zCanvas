define("utils/EventHandler",["module"],function(t){"use strict";function e(){this._eventMappings=[],this._disposed=!1}t.exports=e,e.prototype.addEventListener=function(t,e,i){if(!this.hasEventListener(t,e)){if(t.addEventListener)t.addEventListener(e,i,!1);else{if(!t.attachEvent)return!1;t.attachEvent("on"+e,i)}return this._eventMappings.push({element:t,type:e,listener:i}),!0}return!1},e.prototype.hasEventListener=function(t,e){for(var i=this._eventMappings.length;i--;){var n=this._eventMappings[i];if(n.element===t&&n.type==e)return!0}return!1},e.prototype.removeEventListener=function(t,e){for(var i=this._eventMappings.length;i--;){var n=this._eventMappings[i];if(n.element===t&&n.type===e){if(t.removeEventListener)t.removeEventListener(e,n.listener,!1);else{if(!t.detachEvent)return!1;t.detachEvent("on"+e,n.listener)}return this._eventMappings.splice(i,1),!0}}return!1},e.prototype.dispose=function(){if(!this._disposed){this._disposed=!0;for(var t=this._eventMappings.length;t--;){var e=this._eventMappings[t];this.removeEventListener(e.element,e.type)}this._eventMappings=null}}}),define("utils/Environment",["module"],function(t){"use strict";t.exports={hasTouchEvents:function(){return!!("ontouchstart"in window)},isMobile:function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(window.navigator.userAgent||window.navigator.vendor||window.opera),t}}}),define("utils/OOP",["module"],function(t){"use strict";var e=t.exports={extend:function(t,i){function n(){}n.prototype=i.prototype,t.superClass_=i.prototype,t.prototype=new n,t.prototype.constructor=t,t.super=function(t,e,n){for(var o=new Array(arguments.length-2),s=2;s<arguments.length;s++)o[s-2]=arguments[s];return i.prototype[e].apply(t,o)},t.extend=function(i){e.extend(i,t)}}}}),define("Canvas",["module","utils/EventHandler","utils/Environment","utils/OOP"],function(t,e,i,n){"use strict";function o(t,e,i,n){var o=void 0;if(o="number"==typeof t?{width:t,height:e,animate:i,fps:n}:"object"===("undefined"==typeof t?"undefined":s(t))?t:{},t="number"==typeof o.width?o.width:300,e="number"==typeof o.height?o.height:300,t<=0||e<=0)throw new Error("cannot construct a zCanvas without valid dimensions");this.DEBUG="boolean"==typeof o.debug&&o.debug,this._fps="number"==typeof o.fps?o.fps:60,this._renderInterval=1e3/this._fps,this._animate="boolean"==typeof o.animate&&o.animate,this._smoothing=!0,this._stretchToFit="boolean"==typeof o.stretchToFit&&o.stretchToFit,this._updateHandler="function"==typeof o.onUpdate?o.onUpdate:null,this._renderHandler=this.render.bind(this),this._lastRender=0,this._renderId=0,this._renderPending=!1,this._disposed=!1,this._children=[],this._element=document.createElement("canvas"),this._canvasContext=this._element.getContext("2d");var r=window.devicePixelRatio||1,a=this._canvasContext.webkitBackingStorePixelRatio||this._canvasContext.mozBackingStorePixelRatio||this._canvasContext.msBackingStorePixelRatio||this._canvasContext.oBackingStorePixelRatio||this._canvasContext.backingStorePixelRatio||1,h=r/a;this._HDPIscaleRatio=r!==a?h:1,this.setDimensions(t,e),"boolean"==typeof o.smoothing&&this.setSmoothing(o.smoothing),this.preventEventBubbling(!1),this.addListeners(),this._stretchToFit&&this.stretchToFit(!0),this._animate&&this.render()}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=o,o.extend=function(t){n.extend(t,o)},o.prototype.insertInPage=function(t){if(this._element.parentNode)throw new Error("Canvas already present in DOM");t.appendChild(this._element)},o.prototype.getElement=function(){return this._element},o.prototype.preventEventBubbling=function(t){this._preventDefaults=t},o.prototype.addChild=function(t){if(this.contains(t))return this;var e=this._children.length;return e>0&&(t.last=this._children[e-1],t.last.next=t),t.next=null,t.setCanvas(this),t.setParent(this),this._children.push(t),this.invalidate(),this},o.prototype.removeChild=function(t){t.setParent(null),t.setCanvas(null);var e=this._children.indexOf(t);e!==-1&&this._children.splice(e,1);var i=t.last,n=t.next;return i&&(i.next=n),n&&(n.last=i),t.last=t.next=null,this.invalidate(),t},o.prototype.getChildAt=function(t){return this._children[t]},o.prototype.removeChildAt=function(t){return this.removeChild(this.getChildAt(t))},o.prototype.numChildren=function(){return this._children.length},o.prototype.getChildren=function(){return this._children},o.prototype.contains=function(t){return this._children.indexOf(t)>-1},o.prototype.invalidate=function(){this._animate||this._renderPending||(this._renderPending=!0,this._renderId=window.requestAnimationFrame(this._renderHandler))},o.prototype.getFrameRate=function(){return this._fps},o.prototype.getRenderInterval=function(){return this._renderInterval},o.prototype.setSmoothing=function(t){var e=["imageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","webkitImageSmoothingEnabled"],i=this._canvasContext;this._smoothing=t,window.requestAnimationFrame(function(){e.forEach(function(e){void 0!==i[e]&&(i[e]=t)})})},o.prototype.getWidth=function(){return this._width},o.prototype.getHeight=function(){return this._height},o.prototype.setDimensions=function(t,e,i){var n=this._HDPIscaleRatio;this._width=t,this._height=e,i!==!1&&(this._preferredWidth=t,this._preferredHeight=e),this._element.width=t*n,this._element.height=e*n,this._element.style.width=t+"px",this._element.style.height=e+"px",this._canvasContext.scale(n,n),this._smoothing===!1&&this.setSmoothing(this._smoothing),this.invalidate()},o.prototype.setBackgroundColor=function(t){this._bgColor=t},o.prototype.setAnimatable=function(t){var e=this._animate;this._animate=t,!t||e||this._renderPending||this._renderHandler()},o.prototype.isAnimatable=function(){return this._animate},o.prototype.drawImage=function(t,e,i,n,o,s,r,a,h){if(e=.5+e<<0,i=.5+i<<0,n=.5+n<<0,o=.5+o<<0,!(n<=0||o<=0))if("number"==typeof s){n=Math.min(this._canvasContext.canvas.width,n),o=Math.min(this._canvasContext.canvas.height,o);var d=n/a,l=o/h;s+a>t.width&&(n-=d*(s+a-t.width),a-=s+a-t.width),r+h>t.height&&(o-=l*(r+h-t.height),h-=r+h-t.height),this._canvasContext.drawImage(t,s,r,a,h,e,i,n,o)}else this._canvasContext.drawImage(t,e,i,n,o)},o.prototype.stretchToFit=function(t){var e=this._preferredWidth,i=this._preferredHeight,n=document.documentElement.clientWidth,o=document.documentElement.clientHeight,s=void 0,r=void 0;if(o>n){var a=t===!0?Math.round(o/n*e):i;this.setDimensions(e,a,!1),s=n/e,r=o/a}else{var h=t===!0?Math.round(n/o*i):e;this.setDimensions(h,i,!1),s=n/h,r=o/i}var d=this.getElement(),l="scale("+s+", "+r+")";d.style["-webkit-transform-origin"]=d.style["transform-origin"]="0 0",t===!0?d.style["-webkit-transform"]=d.style.transform=l:d.style["-webkit-transform"]=d.style.transform=""},o.prototype.dispose=function(){if(!this._disposed){this._disposed=!0,this.removeListeners(),this._animate=!1,window.cancelAnimationFrame(this._renderId);for(var t=this.numChildren();t--;)this._children[t].dispose();this._children=[]}},o.prototype.handleInteraction=function(t){var e=this._children.length,i=0,n=0,o=void 0,s=void 0,r=void 0;if(e>0)switch(o=this._children[e-1],t.type){default:if(s=t.touches.length>0?t.touches:t.changedTouches,s.length>0){var a=this.getCoordinate();i=s[0].pageX-a.x,n=s[0].pageY-a.y}for(;o;)o.handleInteraction(i,n,t),o=o.last;break;case"mousedown":case"mousemove":case"mouseup":for(;o&&!(r=o.handleInteraction(t.offsetX,t.offsetY,t));)o=o.last}this._preventDefaults&&(t.stopPropagation(),t.preventDefault()),this.invalidate()},o.prototype.render=function(){var t=Date.now(),e=t-this._lastRender;this._renderPending=!1,this._lastRender=t-e%this._renderInterval;var i=this._canvasContext,n=void 0;if(i){this._bgColor?(i.fillStyle=this._bgColor,i.fillRect(0,0,this._width,this._height)):i.clearRect(0,0,this._width,this._height);var o="function"==typeof this._updateHandler;if(o&&this._updateHandler(t),this._children.length>0)for(n=this._children[0];n;)o||n.update(t),n.draw(i),n=n.next}this._disposed||!this._animate||this._renderPending||(this._renderPending=!0,this._renderId=window.requestAnimationFrame(this._renderHandler))},o.prototype.addListeners=function(){var t=this;this._eventHandler||(this._eventHandler=new e);var n=this.handleInteraction.bind(this);i.hasTouchEvents()&&(this._eventHandler.addEventListener(this._element,"touchstart",n),this._eventHandler.addEventListener(this._element,"touchmove",n),this._eventHandler.addEventListener(this._element,"touchend",n)),i.isMobile()||(this._eventHandler.addEventListener(this._element,"mousedown",n),this._eventHandler.addEventListener(this._element,"mousemove",n),this._eventHandler.addEventListener(window,"mouseup",n)),this._stretchToFit&&!function(){var e=t,n=window.msMatchMedia||window.MozMatchMedia||window.WebkitMatchMedia||window.matchMedia;if(i.isMobile()&&"undefined"!=typeof n)window.matchMedia("(orientation: portrait)").addListener(function(){return e.stretchToFit(!0)});else{var o="onorientationchange"in window?"orientationchange":"resize";t._eventHandler.addEventListener(window,o,function(t){return e.stretchToFit(!0)})}}()},o.prototype.removeListeners=function(){this._eventHandler&&this._eventHandler.dispose(),this._eventHandler=null},o.prototype.getCoordinate=function(){for(var t=0,e=0,i=this._element;i.offsetParent;)t+=i.offsetLeft,e+=i.offsetTop,i=i.offsetParent;return t+=i.offsetLeft,e+=i.offsetTop,{x:t,y:e}}}),define("Loader",["module","utils/EventHandler"],function(t,e){"use strict";function i(t,e){s(t)||(e.crossOrigin="Anonymous")}function n(t){var e=("string"==typeof t?t:t.src).substr(0,5);return"data:"===e||"blob:"===e}function o(t){return{width:t.width||t.naturalWidth,height:t.height||t.naturalHeight}}function s(t){if("./"===t.substr(0,2)||0===t.indexOf(window.location.protocol+"//"+window.location.host))return!0;var e=t.split("#")[0].split("?")[0];if(e.indexOf(".html")>-1){var i=e.split("/"),n=i.length;e=e.split(i[n-1]).join("")}if(e){var o=e.match(/^http[s]?:/);if(Array.isArray(o)&&o.length>0)return!1}return!0}function r(t){var e={image:t,size:null};return t instanceof window.HTMLImageElement&&(e.size=o(t)),e}var a=t.exports={loadImage:function(t,o,s){if(s instanceof window.Image&&a.isReady(s))return void o(r(s));var h=s instanceof window.Image?s:new window.Image,d=n(t),l=new e,p=function(t){l.dispose(),o(r(h),new Error(t.type))},u=function(){l.dispose(),a.onReady(h,function(){return o(r(h))})},c=/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent);d&&!c||(d||i(t,h),l.addEventListener(h,"load",u),l.addEventListener(h,"error",p)),h.src=t,d&&o(r(h))},isReady:function(t){return!("boolean"==typeof t.complete&&!t.complete)&&!("undefined"!=typeof t.naturalWidth&&0===t.naturalWidth)},onReady:function(t,e,i){function n(){a.isReady(t)?e():++s===o?("function"==typeof i&&i(),console.warn("Image could not be resolved. This shouldn't occur.")):window.requestAnimationFrame(n)}var o=60,s=0;n()}}}),define("Sprite",["module","utils/OOP","Loader"],function(t,e,i){"use strict";function n(t,e,i,s,r,a,h){var d=void 0;if("number"==typeof t)d={x:t,y:e,width:i,height:s,bitmap:r,collidable:a,mask:h};else{if("object"!==("undefined"==typeof t?"undefined":o(t)))throw new Error("Sprite must either be constructed using a definitions Object {} or x, y, width, height, bitmap (optional), collidable (optional), mask (optional)");d=t}if("number"!=typeof d.width||"number"!=typeof d.height)throw new Error("cannot construct a zSprite without valid dimensions");if("number"!=typeof d.x&&(d.x=0),"number"!=typeof d.y&&(d.y=0),this._children=[],this._disposed=!1,this.collidable="boolean"==typeof d.collidable&&d.collidable,this.hover=!1,this._mask="boolean"==typeof d.mask&&d.mask,this._bounds={left:0,top:0,width:d.width,height:d.height},this._parent=null,this.last=null,this.next=null,n.prototype.canvas=null,this._bitmap,this._bitmapReady=!1,this._draggable=!1,this._interactive=!1,this._keepInBounds=!1,this.isDragging=!1,this.setX(d.x),this.setY(d.y),d.bitmap&&this.setBitmap(d.bitmap),Array.isArray(d.sheet)&&d.sheet.length>0){if(!d.bitmap)throw new Error("cannot use a spritesheet without a valid Bitmap");this.setSheet(d.sheet,d.sheetTileWidth,d.sheetTileHeight)}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=n,n.extend=function(t){e.extend(t,n)},n.prototype.getDraggable=function(){return this._draggable},n.prototype.setDraggable=function(t,e){this._draggable=t,this._keepInBounds=e||!1,t&&!this._interactive&&this.setInteractive(!0)},n.prototype.getX=function(){return this._bounds.left},n.prototype.setX=function(t){var e=t-this._bounds.left;if(this._bounds.left=this._constraint?t+this._constraint.left:t,this._children.length>0)for(var i=this._children[0];i;)i.isDragging||i.setX(i._bounds.left+e),i=i.next},n.prototype.getY=function(){return this._bounds.top},n.prototype.setY=function(t){var e=t-this._bounds.top;if(this._bounds.top=this._constraint?t+this._constraint.top:t,this._children.length>0)for(var i=this._children[0];i;)i.isDragging||i.setY(i._bounds.top+e),i=i.next},n.prototype.getWidth=function(){return this._bounds.width},n.prototype.setWidth=function(t){var e=this._bounds.width||0;this._bounds.width=t,0!==e&&(this._bounds.left-=.5*t-.5*e)},n.prototype.getHeight=function(){return this._bounds.height},n.prototype.setHeight=function(t){var e=this._bounds.height||0;this._bounds.height=t,0!==e&&(this._bounds.top-=.5*t-.5*e)},n.prototype.setBounds=function(t,e,i,n){if("number"!=typeof t&&(t=this._bounds.left),"number"!=typeof e&&(e=this._bounds.top),this._constraint)t-=this._constraint.left,e-=this._constraint.top;else if(!this.canvas)throw new Error("cannot update position of a Sprite that has no constraint or is not added to a canvas");"number"==typeof i&&(this._bounds.width=i),"number"==typeof n&&(this._bounds.height=n);var o=this._bounds.width,s=this._bounds.height,r=this._constraint?this._constraint.width:this.canvas.width,a=this._constraint?this._constraint.height:this.canvas.height;if(this._keepInBounds){var h=Math.min(0,-(o-r)),d=Math.min(0,-(s-a)),l=r-o,p=a-s;t=Math.min(l,Math.max(t,h)),e=Math.min(p,Math.max(e,d))}else t>r&&(t+=.5*o),e>a&&(e+=.5*s);this.setX(t),this.setY(e)},n.prototype.getBounds=function(){return this._bounds},n.prototype.getInteractive=function(){return this._interactive},n.prototype.setInteractive=function(t){this._interactive=t},n.prototype.update=function(t){if(this._children.length>0)for(var e=this._children[0];e;)e.update(t),e=e.next;this._animation&&this.updateAnimation()},n.prototype.draw=function(t){if(this.canvas){if(t.save(),this._mask&&(t.globalCompositeOperation="destination-in"),this._bitmapReady){var e=this._bounds,i=this._animation;if(i){var n=i.tileWidth?i.tileWidth:.5+e.width<<0,o=i.tileHeight?i.tileHeight:.5+e.height<<0;t.drawImage(this._bitmap,i.col*n,i.type.row*o,n,o,.5+e.left<<0,.5+e.top<<0,.5+e.width<<0,.5+e.height<<0)}else t.drawImage(this._bitmap,.5+e.left<<0,.5+e.top<<0,.5+e.width<<0,.5+e.height<<0)}if(this._children.length>0)for(var s=this._children[0];s;)s.draw(t),s=s.next;this._mask&&(t.globalCompositeOperation="source-over"),t.restore(),this.canvas.DEBUG&&this.drawOutline(t)}},n.prototype.collidesWith=function(t){if(t===this)return!1;var e=this._bounds,i=t.getBounds();return!(e.top+e.height<i.top||e.top>i.top+i.height||e.left+e.width<i.left||e.left>i.left+i.width)},n.prototype.getIntersection=function(t){if(this.collidesWith(t)){var e=this._bounds,i=t.getBounds(),n=Math.max(e.left,i.left),o=Math.max(e.top,i.top),s=Math.min(e.left+e.width,i.width+i.height)-n,r=Math.min(e.top+e.height,i.top+i.height)-o;return{left:n,top:o,width:s,height:r}}return null},n.prototype.collidesWithEdge=function(t,e){if(t===this)return!1;if(isNaN(e)||e<0||e>3)throw new Error("invalid argument for edge");switch(e){case 0:return this.getX()<=t.getX()+t.getWidth();case 1:return this.getY()<=t.getY()+t.getHeight();case 2:return this.getX()+this.getWidth()<=t.getX();case 3:return this.getY()+this.getHeight()>=t.getY()}return!1},n.prototype.getBitmap=function(){return this._bitmap},n.prototype.setBitmap=function(t,e,n){var o=this;if(this._bitmap!==t&&(this._bitmapReady=!1),!t)return void(this._bitmap=null);var s="number"==typeof e,r="number"==typeof n;if(s&&this.setWidth(e),r&&this.setHeight(n),this._keepInBounds&&this.canvas&&(s||r)){var a=-(this._bounds.width-this.canvas.getWidth()),h=-(this._bounds.height-this.canvas.getHeight());this._bounds.left>0?this._bounds.left=0:this._bounds.left<a&&(this._bounds.left=a),this._bounds.top>0?this._bounds.top=0:this._bounds.top<h&&(this._bounds.top=h)}if(t instanceof window.HTMLCanvasElement)this._bitmap=t,this._bitmapReady=!0;else{if(!(t instanceof window.HTMLImageElement||"string"==typeof t))throw new Error("expected HTMLImageElement, HTMLCanvasElement or String for Image source, got "+t+" instead");!function(){var e=o;i.loadImage(t,function(t,i){i instanceof Error?console.error(i.message+" occurred. Could not setBitmap()"):(e._bitmap=t.image,e._bitmapReady=!0,o._bitmapWidth=t.size.width,o._bitmapHeight=t.size.height)})}()}},n.prototype.setSheet=function(t,e,i){return this._sheet=t,t?(this._animation={type:null,col:0,maxCol:0,fpt:0,counter:0},"number"==typeof e&&(this._animation.tileWidth=e),"number"==typeof i&&(this._animation.tileHeight=i),void this.switchAnimation(0)):void(this._animation=null)},n.prototype.switchAnimation=function(t){var e=this._animation,i=this._sheet[t];e.type=i,e.fpt=i.fpt,e.maxCol=i.col+(i.amount-1),e.col=i.col,e.counter=0,e.onComplete=i.onComplete},n.prototype.setParent=function(t){this._parent=t},n.prototype.getParent=function(){return this._parent},n.prototype.setCanvas=function(t){this.canvas=t},n.prototype.setConstraint=function(t,e,i,n){return this._constraint={left:t,top:e,width:i,height:n},this._bounds.left=Math.max(t,this._bounds.left),this._bounds.top=Math.max(e,this._bounds.top),this._keepInBounds=!0,this._constraint},n.prototype.getConstraint=function(){return this._constraint},n.prototype.addChild=function(t){if(this.contains(t))return this;var e=this._children.length;return e>0&&(t.last=this._children[e-1],t.last.next=t,t.next=null),t.setCanvas(this.canvas),t.setParent(this),this._children.push(t),this.canvas&&this.canvas.invalidate(),this},n.prototype.removeChild=function(t){t.setParent(null),t.setCanvas(null);var e=this._children.indexOf(t);e!==-1&&this._children.splice(e,1);var i=t.last,n=t.next;return i&&(i.next=n),n&&(n.last=i),t.last=t.next=null,this.canvas&&this.canvas.invalidate(),t},n.prototype.getChildAt=function(t){return this._children[t]},n.prototype.removeChildAt=function(t){return this.removeChild(this.getChildAt(t))},n.prototype.numChildren=function(){return this._children.length},n.prototype.contains=function(t){return this._children.indexOf(t)>-1},n.prototype.dispose=function(){if(!this._disposed){this._disposed=!0,this._parent&&this._parent.removeChild(this);for(var t=this._children.length;t--;){var e=this._children[t];e.dispose(),e.next=e.last=null}this._children=[]}},n.prototype.handlePress=function(t,e){},n.prototype.handleRelease=function(t,e){},n.prototype.handleClick=function(){},n.prototype.handleMove=function(t,e){var i=this._dragStartOffset.x+(t-this._dragStartEventCoordinates.x),n=this._dragStartOffset.y+(e-this._dragStartEventCoordinates.y);this.setBounds(i,n)},n.prototype.handleInteraction=function(t,e,i){var n=!1,o=void 0,s=this.getX(),r=this.getY(),a=this._children.length;if(a>0)for(o=this._children[a-1];o;){if(n=o.handleInteraction(t,e,i))return!0;o=o.last}if(!this._interactive)return!1;if(this.isDragging&&("touchend"===i.type||"mouseup"===i.type))return this.isDragging=!1,Date.now()-this._dragStartTime<250&&this.handleClick(),this.handleRelease(t,e),!0;var h=this._bounds;if(t>=s&&t<=s+h.width&&e>=r&&e<=r+h.height){if(this.hover=!0,!this.isDragging&&("touchstart"===i.type||"mousedown"===i.type))return this.isDragging=!0,this._dragStartTime=Date.now(),this._dragStartOffset={x:this._bounds.left,y:this._bounds.top},this._dragStartEventCoordinates={x:t,y:e},this.handlePress(t,e),!0}else this.hover=!1;return!(!this._draggable||!this.isDragging)&&(this.handleMove(t,e),!0)},n.prototype.updateAnimation=function(){var t=this._animation;++t.counter===t.fpt&&(++t.col,t.counter=0),t.col>t.maxCol&&(t.col=t.type.col,"function"==typeof t.onComplete&&t.onComplete(this))},n.prototype.drawOutline=function(t){t.lineWidth=1,t.strokeStyle="#FF0000",t.strokeRect(this.getX(),this.getY(),this.getWidth(),this.getHeight())}}),define("Collision",["module"],function(t){"use strict";var e=document.createElement("canvas"),i=e.getContext("2d"),n=t.exports={pixelCollision:function(t,e,i){var o=t.getIntersection(e);if(null===o)return!1;var s=n.getPixelArray(t,o),r=n.getPixelArray(e,o),a=0;if(i===!0)for(var h=0;h<o.height;++h)for(var d=0;d<o.width;++d){if(0!==s[a]&&0!==r[a])return{x:d,y:h};++a}else for(a;a<s.length;++a)if(0!==s[a]&&0!==r[a])return!0;return!1},getPixelArray:function(t,n){var o=t.getBitmap(),s=t.getBounds(),r=parseInt(n.left-s.left),a=parseInt(n.top-s.top),h=parseInt(n.width),d=parseInt(n.height);0===h&&(h=1),0===d&&(d=1);var l=!(o instanceof window.HTMLCanvasElement),p=l?e:o,u=l?i:o.getContext("2d");l&&(p.width=s.width,p.height=s.height,u.clearRect(0,0,e.width,e.height),u.drawImage(o,0,0,s.width,s.height));for(var c=u.getImageData(r,a,h,d),f=c.data,m=new Array(parseInt(h*d)),g=0,v=0;v<d;++v)for(var _=0;_<h;++_){var y=4*(v*h+_);m[g]=f[y+3]<<24|f[y]<<16|f[y+1]<<8|f[y+2],++g}return m},getChildrenUnderPoint:function(t,e,i,n,o,s){for(var r=[],a=t.length,h=void 0,d=void 0,l=void 0,p=void 0,u=void 0;a--;)h=t[a],d=h.getX(),l=h.getY(),p=h.getWidth(),u=h.getHeight(),d<e+n&&d+p>e&&l<i+o&&l+u>i&&(!s||s&&h.collidable)&&r.push(h);return r}}}),define("zcanvas.amd",["module","Canvas","Sprite","Loader","Collision"],function(t,e,i,n,o){"use strict";t.exports={canvas:e,sprite:i,loader:n,collision:o}});